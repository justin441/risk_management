{% extends 'risk_register/base.html' %}
{% load i18n %}

{% block title %}
  {{ class_name }}
{% endblock %}

{% block content %}
  {% block header %}
    <h2>{{ class_name }}</h2>
  {% endblock %}

  {% block data %}
    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
        <tr>
          <th style="width:15%;">{% trans 'Nom' %}</th>
          <th style="width:60%;">{% trans 'Description' %}</th>
          <th style="width:15%;">{% trans 'Créé par' %}</th>
          <th style="width:10%;">{% trans 'Occurrences' %}</th>
        </tr>
        </thead>
        <tbody>
        {% for risk in risks_list %}
          <tr>
            <td style="min-width:175px;">
              {% if risk.cree_par == request.user %}
                <a href="{% url 'risk_register:modifier_risque' pk=risk.pk %}" class="fm-update"
                   data-fm-head="{% trans 'Modifier un risque' %}" data-fm-callback="reload">
                  {{ risk.nom }}
                </a>
              {% else %}
                <a href="{% url 'risk_register:detail_risque' pk=risk.pk %}" class="fm-detail"
                   data-fm-head="{{ risk.nom }}" data-fm-callback="">
                  {{ risk.nom }}
                </a>

              {% endif %}
            </td>
            <td style="min-width: 400px;">{{ risk.description }}</td>
            <td style="min-width: 175px">{{ risk.cree_par|default_if_none:_('inconnu') }}</td>
            <td style="min-width: 150px;">
              <a href="">
                {% if risk.processusrisque_set.count|add:risk.activiterisque_set.count <= 1 %}
                  {{ risk.processusrisque_set.count|add:risk.activiterisque_set.count }} {% trans 'occurrence' %}
                {% else %}
                  {{ risk.processusrisque_set.count|add:risk.activiterisque_set.count }} {% trans 'occurrences' %}
                {% endif %}
              </a>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

  {% endblock %}
{% endblock %}
